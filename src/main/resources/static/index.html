<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
            integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
            crossorigin="anonymous"></script>
</head>
<script>

    const loadAllEmployees = () => {
        let domain = window.location.origin;
        fetch(domain + '/employees')
            .then(response => response.json())
            .then(employees => {
                for (const [key, value] of Object.entries(employees)) {
                    $("#employeeGridBody")
                        .append('<tr>' +
                            '<th>' + '<a href="' + domain + '/employee_details.html?id=' + value.employeeId +
                            '" target="_blank">' + value.employeeId + '</a>' + '</th>' +
                            '<td>' + value.firstName + '</td>' +
                            '<td>' + value.lastName + '</td>' +
                            '</tr>');
                }
            })
    }

    const loadEmployeesByRequest = () => {
        cleanEmployees();
        let domain = window.location.origin;
        let searchRequest = document.getElementById('employeeSearchRequestId').value;
        if (searchRequest.length === 4) {
        fetch(domain + '/employees/' + searchRequest)
            .then(response => response.json())
            .then(employees => {
                for (const [key, value] of Object.entries(employees)) {
                    $("#employeeSearchGridBody")
                        .append('<tr>' +
                            '<th>' + value.employeeId + '</th>' +
                            '<td>' + value.firstName + '</td>' +
                            '<td>' + value.lastName + '</td>' +
                            '<td>' + value.streetAddress + '</td>' +
                            '</tr>');
                }
            })
        } else {
            alert('enter four characters to search');
        }
    }

    const cleanEmployees = () => {
        $("#employeeSearchGridBody").empty();
    }
</script>

<div class="container text-center my-5">
    <div class="col-lg-6 col-md-8 mx-auto">
        <img src="office.jpg" alt="Office" />
    </div>
</div>


<body onload="loadAllEmployees();">

<div style="display:flex; justify-content: space-between">
    <div style="width: 300px">
        <table class="table table-striped" id="employeeGrid">
            <thead id="employeeGridHead">
            <tr>
                <th>Employee ID</th>
                <th>First Name</th>
                <th>Last Name</th>
            </tr>
            </thead>
            <tbody id="employeeGridBody">
            </tbody>
        </table>
    </div>

    <div style="width: 1000px">
        <div>
            <input style="width: 100%" id="employeeSearchRequestId" placeholder="Enter employee search here">
        </div>

        <div style="display: flex; justify-content: space-around; width: 1000px; margin: 0 auto">
            <button type="button" onclick="loadEmployeesByRequest(); this.blur();" class="p-2 m-2 btn btn-secondary">
                Search employees
            </button>

            <button type="button" onclick="cleanEmployees(); this.blur();" class="p-2 m-2 btn btn-secondary">
                Clean employees
            </button>
        </div>

        <div>
            <table class="table table-striped" id="employeeSearchGrid">
                <thead id="employeeSearchGridHead">
                <tr>
                    <th>Employee ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Street Address</th>
                </tr>
                </thead>
                <tbody id="employeeSearchGridBody">
                </tbody>
            </table>
        </div>
    </div>

    <div>
        <a href="/chart.html" style="width: 300px" onclick="this.blur();"
           class="p-2 m-2 btn btn-danger" role="button" target="_blank">
            Salaries chart employees
        </a>
    </div>
</div>
</body>
</html>